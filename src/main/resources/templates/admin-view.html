﻿<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <link rel="stylesheet" href="css/logowanie.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>Widok admina</title>
</head>
<body>
<div class="container dashboard">
    <h2>Zarządzanie uprawnieniami</h2>
    <h4 th:text="'Aktywny użytkownik: '+${username}"/>
    <h4>
        <form style="display: inline" action="/" method="get">
            <button type="submit" class="btn btn-md btn-primary">Zarządzaj danymi</button>
        </form>
        <form method="get" th:action="@{/offering}">
            <button type="submit" class="btn btn-md btn-primary">
                Przekaż uprawnienia
            </button>
        </form>
        <form method="post" th:action="@{/logout}">
            <input type="hidden"
                   th:name="${_csrf.parameterName}"
                   th:value="${_csrf.token}"/>
            <button type="submit" class="btn btn-md btn-warning">Wyloguj</button>
        </form>
    </h4>
    <div class="panel panel-default main dashboard" style="padding-left: 12px; padding-top: 0px">
        <div class="divTable">
            <p th:each="privilege: ${privileges}" th:text="${privilege.getReceiver().getLogin()}"></p>
        </div>
    </div>
</div>
<script th:inline="javascript">
    /*<![CDATA[*/
    function changeGrantMode(mode) {
        var token = $("meta[name='_csrf']").attr("content");
        //$('body').load("/offering?grantMode=" + mode);
        $.ajax({
            url: "/offering?grantMode=" + mode,
            headers: {'X-CSRF-TOKEN': token},
            type: "GET"
        }).done(function (data) {
            $('body').html(data);
        });
    }
    /*]]>*/
</script>
</body>
</html>